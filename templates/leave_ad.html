<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leave Control Center</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='leave_ad.css') }}">
</head>
<body>
  <!-- Navbar -->
  <div class="navbar" style="z-index: 100000;">
        <div id="option">
          <i class="fa-solid fa-bars" onclick=menu()></i>
        </div>
    <div class="name">
      <img src="{{ url_for('static', filename='epical.png') }}" height="50px" width="60px">
      <nav>
        <h1>Epical Layout</h1>
        <p>Admin Portal</p></nav>
        </div>
        <div class="nav-elements">
            
            
            <nav class="a" id="b">
                <i class="bi bi-moon-fill"></i>
            </nav>
            <nav class="a" id="c" style="margin-right: 30px;">
        <i class="fas fa-user-circle" id="user-icon"></i>  <!-- solid user circle -->
            </nav>
        </div>
    </div>
        <div id="side-bar">
      <a href="{{ url_for('admindashboard') }}">
        <ul>
        <i class="fa-solid fa-house"></i><p>Dashboard</p>
        </ul></a>
      <a href="{{ url_for('timeadmin') }}"><ul>
          <i class="fa-regular fa-clock"></i><p>Timesheet</p>
      </ul></a>
      <a href="{{ url_for('leave_ad') }}"><ul>
        <i class="fa-solid fa-user-pen"></i><p>Leave Management</p>
      </ul></a>
      <a href="{{ url_for('publicholiday') }}"><ul>
        <i class="fa-regular fa-calendar"></i><p>Holiday Planner</p>
      </ul></a>
      <a href="{{ url_for('showemployee') }}"><ul>
        <i class="fa-regular fa-user"></i><p>Employee</p>
      </ul></a>
      <p>Quick-Actions</p>
      <a href=""><ul>
        <i class="fa-solid fa-flask"></i><p>Lab</p>
      </ul></a>
      <a href="{{ url_for('payslipad') }}"><ul>
        <i class="fa-solid fa-upload"></i><p>Upload Payslip</p>
      </ul></a>
      <a href=""><ul>
        <i class="fa-solid fa-id-card"></i><p>Upload Documents</p>
      </ul></a>
    </div>

  <!-- Main Section -->
  <div class="left">
    <div class="container">
      <header>
        <h1>Leave Control Center</h1>
        <p>Smart Leave Management System</p>
      </header>

      <!-- Chart -->
      <canvas id="leaveChart" width="400" height="120"></canvas>

      <!-- Filter Controls -->
      <input type="text" id="searchInput" placeholder="ðŸ” Search employee..." />
      <select id="statusFilter">
        <option value="">All Statuses</option>
        <option value="approved">Approved</option>
        <option value="pending">Pending</option>
        <option value="rejected">Rejected</option>
      </select>

      <!-- Leave Table -->
      <section class="approvals">
        <table>
          <thead>
            <tr>
              <th>Employee</th>
              <th>Leave Type</th>
              <th>Dates</th>
              <th>Reason</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="leaveTableBody">
            

            {% for i in range(2, leaves|length) %}
              <tr>
                <td>{{ leaves[i][0] }}</td>
                <td>{{ leaves[i][1] }}</td>
                <td data-from="{{ leaves[i][2] }}" data-to="{{ leaves[i][3] }}">
                  {{ leaves[i][2] }} â†’ {{ leaves[i][3] }}
                </td>
                <td>{{ leaves[i][5] }}</td>
                <td>
                  <span class="badge {% if leaves[i][6] == 'Accepted' %}green{% elif leaves[i][6] == 'Rejected' %}red{% else %}yellow{% endif %}">
                    {{ leaves[i][6] or 'Pending' }}
                  </span>
                </td>
                
                <td>
                  <button 
                    class="approve"
                    data-employee="{{ leaves[i][0] }}"
                    data-from="{{ leaves[i][2] }}"
                    data-to="{{ leaves[i][3] }}"
                    {% if leaves[i][6] != 'Pending' %}disabled style="opacity:0.5"{% endif %}>
                    âœ” Accept
                  </button>
                  <button 
                    class="reject"
                    data-employee="{{ leaves[i][0] }}"
                    data-from="{{ leaves[i][2] }}"
                    data-to="{{ leaves[i][3] }}"
                    {% if leaves[i][6] != 'Pending' %}disabled style="opacity:0.5"{% endif %}>
                    âœ– Reject
                  </button>
                </td>
                
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>

      <!-- Calendar -->
      <h2 style="margin-top: 15px;padding-top: 5px;">ðŸ“… Calendar</h2>
      <div id="calendar"></div>
    </div>

    <!-- Profile Popup -->
    <div class="profile-popup" id="profilePopup">
      <div class="close-popup" id="closePopup"><i class="fas fa-times"></i></div>
      <div class="profile-header">
        <img src="https://randomuser.me/api/portraits/men/32.jpg" class="profile-pic" alt="Profile">
        <h3>John Doe</h3>
        <p>Software Engineer</p>
      </div>
      <div class="profile-body">
        <div class="profile-info"><h4>Email</h4><p>john.doe@company.com</p></div>
        <div class="profile-info"><h4>Employee ID</h4><p>EMP-2048</p></div>
        <div class="profile-info"><h4>Department</h4><p>Engineering - IT</p></div>
        <div class="profile-info"><h4>Join Date</h4><p>March 15, 2020</p></div>
      </div>
      <div class="profile-footer">
        <button class="profile-btn view-profile">View Full Profile</button>
        <button class="profile-btn logout">Log Out</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script src="{{ url_for('static', filename='scrpt/leave_ad.js') }}"></script>
  <script src="{{ url_for('static', filename='scrpt/dark.js') }}"></script>
</body>
</html>
